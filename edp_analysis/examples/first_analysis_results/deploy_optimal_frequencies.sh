#!/bin/bash
# GPU Frequency Deployment Script
# Generated by GPU Frequency Optimization Analysis

if [ $# -ne 2 ]; then
    echo "Usage: $0 <CONFIG> <ACTION>"
    echo "CONFIG: A100+STABLEDIFFUSION, V100+STABLEDIFFUSION"
    echo "ACTION: deploy, reset"
    exit 1
fi

CONFIG=$1
ACTION=$2

if [ "$CONFIG" = "A100+STABLEDIFFUSION" ]; then
    if [ "$ACTION" = "deploy" ]; then
        echo "Deploying A100+STABLEDIFFUSION: 1020MHz"
        sudo nvidia-smi -ac 1215,1020
    elif [ "$ACTION" = "reset" ]; then
        echo "Resetting A100+STABLEDIFFUSION to default"
        sudo nvidia-smi -rac
    fi
fi

if [ "$CONFIG" = "V100+STABLEDIFFUSION" ]; then
    if [ "$ACTION" = "deploy" ]; then
        echo "Deploying V100+STABLEDIFFUSION: 1110MHz"
        sudo nvidia-smi -ac 877,1110
    elif [ "$ACTION" = "reset" ]; then
        echo "Resetting V100+STABLEDIFFUSION to default"
        sudo nvidia-smi -rac
    fi
fi

